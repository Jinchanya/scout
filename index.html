<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠ - ‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏Ñ‡∏≠‡∏£‡πå‡∏™</title>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { box-sizing: border-box; font-family: 'Prompt', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #f3e8ff 0%, #e9d5ff 50%, #ddd6fe 100%); }
        .card-shadow { box-shadow: 0 4px 20px rgba(139, 92, 246, 0.1); }
        .btn-primary { background: linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%); transition: all 0.3s ease; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(139, 92, 246, 0.3); }
        .activity-card { transition: all 0.3s ease; border-left: 4px solid #8b5cf6; }
        .activity-card:hover { transform: translateY(-2px); box-shadow: 0 8px 30px rgba(139, 92, 246, 0.15); }
        .signature-pad { border: 2px dashed #c4b5fd; border-radius: 12px; background: #faf5ff; }
        .rubric-item { background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%); border-radius: 8px; border: 1px solid #e9d5ff; }
        .nav-tab { transition: all 0.3s ease; border-radius: 20px; }
        .nav-tab.active { background: linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%); color: white; transform: scale(1.05); }
        .stats-card { background: linear-gradient(135deg, #ffffff 0%, #faf5ff 100%); border: 1px solid #e9d5ff; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .fade-in { animation: fadeIn 0.5s ease-out; }
        .mobile-menu { transform: translateX(-100%); transition: transform 0.3s ease; }
        .mobile-menu.open { transform: translateX(0); }
        #loadingOverlay { transition: opacity 0.3s ease; }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <div id="loadingOverlay" class="fixed inset-0 bg-white/80 backdrop-blur-sm z-[100] flex items-center justify-center hidden">
        <div class="text-center">
            <svg class="animate-spin h-10 w-10 text-purple-600 mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            <p id="loadingText" class="mt-4 text-purple-700 font-semibold">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
        </div>
    </div>

    <header class="bg-white/80 backdrop-blur-md shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 rounded-full flex items-center justify-center">
                        <span class="text-white text-xl">üèïÔ∏è</span>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold text-gray-800">‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠</h1>
                        <p class="text-sm text-purple-600">‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏Ñ‡∏≠‡∏£‡πå‡∏™ ‡∏°.1-‡∏°.3</p>
                    </div>
                </div>
                <div class="flex items-center space-x-2">
                     <button id="syncButton" onclick="syncDataToSheet()" class="md:flex items-center space-x-2 bg-green-100 text-green-700 px-4 py-2 rounded-lg hover:bg-green-200 transition-colors">
                        <svg id="syncIcon" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h5M20 20v-5h-5M20 4l-5 5M4 20l5-5"></path></svg>
                        <span id="syncButtonText">Sync ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>
                    </button>
                    <button id="mobileMenuBtn" class="md:hidden p-2 rounded-lg bg-purple-100 text-purple-600">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <div id="mobileMenu" class="mobile-menu fixed inset-y-0 left-0 w-64 bg-white shadow-xl z-40 md:hidden">
        <div class="p-4">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-lg font-semibold text-gray-800">‡πÄ‡∏°‡∏ô‡∏π</h2>
                <button id="closeMobileMenu" class="p-2 rounded-lg bg-gray-100 text-gray-600">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            <nav class="space-y-2">
                <button onclick="showTab('dashboard')" class="w-full text-left p-3 rounded-lg hover:bg-purple-50 text-gray-700">üìä ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</button>
                <button onclick="showTab('schedule')" class="w-full text-left p-3 rounded-lg hover:bg-purple-50 text-gray-700">üìÖ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</button>
                <button onclick="showTab('students')" class="w-full text-left p-3 rounded-lg hover:bg-purple-50 text-gray-700">üë• ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠</button>
                <button onclick="showTab('records')" class="w-full text-left p-3 rounded-lg hover:bg-purple-50 text-gray-700">üìù ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</button>
            </nav>
        </div>
    </div>
    
    <div class="container mx-auto px-4 py-6">
        <div class="hidden md:flex bg-white/60 backdrop-blur-md rounded-2xl p-2 mb-6 card-shadow">
            <button onclick="showTab('dashboard')" class="nav-tab px-6 py-3 text-sm font-medium text-gray-600 hover:text-purple-600 flex items-center space-x-2"><span>üìä</span><span>‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</span></button>
            <button onclick="showTab('schedule')" class="nav-tab px-6 py-3 text-sm font-medium text-gray-600 hover:text-purple-600 flex items-center space-x-2 active"><span>üìÖ</span><span>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</span></button>
            <button onclick="showTab('students')" class="nav-tab px-6 py-3 text-sm font-medium text-gray-600 hover:text-purple-600 flex items-center space-x-2"><span>üë•</span><span>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠</span></button>
            <button onclick="showTab('records')" class="nav-tab px-6 py-3 text-sm font-medium text-gray-600 hover:text-purple-600 flex items-center space-x-2"><span>üìù</span><span>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</span></button>
        </div>

        <div id="dashboardTab" class="tab-content hidden">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="stats-card rounded-2xl p-6 card-shadow">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-600">‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                            <p class="text-2xl font-bold text-purple-600" id="totalStudents">0</p>
                        </div>
                        <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center"><span class="text-purple-600 text-xl">üë•</span></div>
                    </div>
                </div>
                <div class="stats-card rounded-2xl p-6 card-shadow">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-600">‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</p>
                            <p class="text-2xl font-bold text-green-600" id="todayActivities">0</p>
                        </div>
                        <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center"><span class="text-green-600 text-xl">üìù</span></div>
                    </div>
                </div>
                <div class="stats-card rounded-2xl p-6 card-shadow">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-600">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</p>
                            <p class="text-2xl font-bold text-blue-600" id="todayAttendance">0</p>
                        </div>
                        <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center"><span class="text-blue-600 text-xl">‚úÖ</span></div>
                    </div>
                </div>
                <div class="stats-card rounded-2xl p-6 card-shadow">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-600">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</p>
                            <p class="text-2xl font-bold text-orange-600" id="averageScore">0</p>
                        </div>
                        <div class="w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center"><span class="text-orange-600 text-xl">‚≠ê</span></div>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-white/80 backdrop-blur-md rounded-2xl p-6 card-shadow">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center"><span class="mr-2">üìä</span>‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</h3>
                    <div class="space-y-4">
                        <div class="flex items-center justify-between">
                            <span class="text-sm text-gray-600">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1</span>
                            <div class="flex items-center space-x-2">
                                <div class="w-32 bg-gray-200 rounded-full h-2"><div class="bg-purple-500 h-2 rounded-full" style="width: 85%"></div></div>
                                <span class="text-sm font-medium text-gray-700">85%</span>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-sm text-gray-600">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 2</span>
                            <div class="flex items-center space-x-2">
                                <div class="w-32 bg-gray-200 rounded-full h-2"><div class="bg-purple-500 h-2 rounded-full" style="width: 92%"></div></div>
                                <span class="text-sm font-medium text-gray-700">92%</span>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-sm text-gray-600">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 3</span>
                            <div class="flex items-center space-x-2">
                                <div class="w-32 bg-gray-200 rounded-full h-2"><div class="bg-purple-500 h-2 rounded-full" style="width: 78%"></div></div>
                                <span class="text-sm font-medium text-gray-700">78%</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="bg-white/80 backdrop-blur-md rounded-2xl p-6 card-shadow">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center"><span class="mr-2">üéØ</span>‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</h3>
                    <div class="space-y-4">
                        <div class="flex items-center justify-between">
                            <span class="text-sm text-gray-600">‡∏°.1</span>
                            <div class="flex items-center space-x-2">
                                <div class="w-32 bg-gray-200 rounded-full h-2"><div class="bg-green-500 h-2 rounded-full" style="width: 88%"></div></div>
                                <span class="text-sm font-medium text-gray-700" id="m1Stats">0 ‡∏Ñ‡∏ô</span>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-sm text-gray-600">‡∏°.2</span>
                            <div class="flex items-center space-x-2">
                                <div class="w-32 bg-gray-200 rounded-full h-2"><div class="bg-blue-500 h-2 rounded-full" style="width: 75%"></div></div>
                                <span class="text-sm font-medium text-gray-700" id="m2Stats">0 ‡∏Ñ‡∏ô</span>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-sm text-gray-600">‡∏°.3</span>
                            <div class="flex items-center space-x-2">
                                <div class="w-32 bg-gray-200 rounded-full h-2"><div class="bg-orange-500 h-2 rounded-full" style="width: 82%"></div></div>
                                <span class="text-sm font-medium text-gray-700" id="m3Stats">0 ‡∏Ñ‡∏ô</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="scheduleTab" class="tab-content">
            <div class="bg-white/80 backdrop-blur-md rounded-2xl p-6 mb-6 card-shadow">
                <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-2">üéØ</span>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <button onclick="showGradeSchedule('m1')" class="grade-btn bg-gradient-to-r from-green-400 to-green-500 text-white p-4 rounded-xl hover:from-green-500 hover:to-green-600 transition-all duration-300 transform hover:scale-105"><div class="text-center"><div class="text-2xl mb-2">üå±</div><h3 class="font-semibold">‡∏°.1</h3><p class="text-sm opacity-90">‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏±‡∏ß</p></div></button>
                    <button onclick="showGradeSchedule('m2')" class="grade-btn bg-gradient-to-r from-blue-400 to-blue-500 text-white p-4 rounded-xl hover:from-blue-500 hover:to-blue-600 transition-all duration-300 transform hover:scale-105"><div class="text-center"><div class="text-2xl mb-2">üöÄ</div><h3 class="font-semibold">‡∏°.2</h3><p class="text-sm opacity-90">‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö</p></div></button>
                    <button onclick="showGradeSchedule('m3')" class="grade-btn bg-gradient-to-r from-orange-400 to-orange-500 text-white p-4 rounded-xl hover:from-orange-500 hover:to-orange-600 transition-all duration-300 transform hover:scale-105"><div class="text-center"><div class="text-2xl mb-2">üëë</div><h3 class="font-semibold">‡∏°.3</h3><p class="text-sm opacity-90">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏ô‡∏≥‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏≤‡∏ï‡∏±‡∏ß‡∏£‡∏≠‡∏î</p></div></button>
                </div>
            </div>
            <div id="scheduleContent" class="bg-white/80 backdrop-blur-md rounded-2xl p-6 card-shadow">
                <p class="text-center text-gray-500 py-8">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</p>
            </div>
        </div>

        <div id="studentsTab" class="tab-content hidden">
            <div class="bg-white/80 backdrop-blur-md rounded-2xl p-6 card-shadow">
                <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 md:mb-0 flex items-center"><span class="mr-2">üë•</span>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠</h2>
                    <button onclick="showAddStudentModal()" class="btn-primary text-white px-6 py-3 rounded-xl font-medium flex items-center space-x-2"><span>‚ûï</span><span>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠</span></button>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                    <select id="gradeFilter" class="p-3 border border-purple-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</option><option value="m1">‡∏°.1</option><option value="m2">‡∏°.2</option><option value="m3">‡∏°.3</option>
                    </select>
                    <select id="groupFilter" class="p-3 border border-purple-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏≠‡∏á</option><option value="1">‡∏Å‡∏≠‡∏á 1</option><option value="2">‡∏Å‡∏≠‡∏á 2</option><option value="3">‡∏Å‡∏≠‡∏á 3</option><option value="4">‡∏Å‡∏≠‡∏á 4</option>
                    </select>
                </div>
                <div id="studentsList" class="space-y-4"></div>
            </div>
        </div>

        <div id="recordsTab" class="tab-content hidden">
            <div class="bg-white/80 backdrop-blur-md rounded-2xl p-6 card-shadow">
                <h2 class="text-xl font-bold text-gray-800 mb-6 flex items-center"><span class="mr-2">üìù</span>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h2>
                <div id="recordsList" class="space-y-4">
                    <p class="text-center text-gray-500 py-8">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</p>
                </div>
            </div>
        </div>
    </div>

    <div id="addStudentModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl p-6 w-full max-w-md card-shadow">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-semibold text-gray-800">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà</h3>
                <button onclick="closeAddStudentModal()" class="p-2 rounded-lg bg-gray-100 text-gray-600 hover:bg-gray-200"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button>
            </div>
            <form id="addStudentForm" class="space-y-4">
                <div><label class="block text-sm font-medium text-gray-700 mb-2">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label><input type="text" id="studentName" class="w-full p-3 border border-purple-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent" required></div>
                <div><label class="block text-sm font-medium text-gray-700 mb-2">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</label><select id="studentGrade" class="w-full p-3 border border-purple-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent" required><option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</option><option value="m1">‡∏°.1</option><option value="m2">‡∏°.2</option><option value="m3">‡∏°.3</option></select></div>
                <div><label class="block text-sm font-medium text-gray-700 mb-2">‡∏Å‡∏≠‡∏á</label><select id="studentGroup" class="w-full p-3 border border-purple-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent" required><option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏≠‡∏á</option><option value="1">‡∏Å‡∏≠‡∏á 1</option><option value="2">‡∏Å‡∏≠‡∏á 2</option><option value="3">‡∏Å‡∏≠‡∏á 3</option><option value="4">‡∏Å‡∏≠‡∏á 4</option></select></div>
                <div><label class="block text-sm font-medium text-gray-700 mb-2">‡∏´‡∏°‡∏π‡πà</label><select id="studentUnit" class="w-full p-3 border border-purple-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent" required><option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏π‡πà</option><option value="1">‡∏´‡∏°‡∏π‡πà 1</option><option value="2">‡∏´‡∏°‡∏π‡πà 2</option><option value="3">‡∏´‡∏°‡∏π‡πà 3</option><option value="4">‡∏´‡∏°‡∏π‡πà 4</option></select></div>
                <div class="flex space-x-3 pt-4"><button type="button" onclick="closeAddStudentModal()" class="flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button><button type="submit" class="flex-1 btn-primary text-white px-4 py-3 rounded-xl">‡πÄ‡∏û‡∏¥‡πà‡∏°</button></div>
            </form>
        </div>
    </div>

    <div id="activityModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl p-6 w-full max-w-6xl max-h-[90vh] overflow-y-auto card-shadow">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-semibold text-gray-800" id="activityModalTitle">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h3>
                <button onclick="closeActivityModal()" class="p-2 rounded-lg bg-gray-100 text-gray-600 hover:bg-gray-200"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button>
            </div>
            <form id="activityForm" class="space-y-6">
                <div class="bg-purple-50 rounded-xl p-4">
                    <h4 class="font-semibold text-purple-800 mb-2">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div><label class="block text-sm font-medium text-gray-700 mb-1">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label><input type="date" id="activityDate" class="w-full p-2 border border-purple-200 rounded-lg focus:ring-2 focus:ring-purple-500"></div>
                        <div><label class="block text-sm font-medium text-gray-700 mb-1">‡πÄ‡∏ß‡∏•‡∏≤</label><input type="text" id="activityTime" class="w-full p-2 border border-purple-200 rounded-lg focus:ring-2 focus:ring-purple-500" readonly></div>
                    </div>
                </div>
                <div class="bg-blue-50 rounded-xl p-4">
                    <h4 class="font-semibold text-blue-800 mb-4">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div><label class="block text-sm font-medium text-gray-700 mb-1">‡∏Å‡∏≠‡∏á</label><select id="modalGroupFilter" class="w-full p-2 border border-blue-200 rounded-lg focus:ring-2 focus:ring-blue-500" onchange="updateModalStudentsList()"><option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏≠‡∏á</option><option value="1">‡∏Å‡∏≠‡∏á 1</option><option value="2">‡∏Å‡∏≠‡∏á 2</option><option value="3">‡∏Å‡∏≠‡∏á 3</option><option value="4">‡∏Å‡∏≠‡∏á 4</option></select></div>
                        <div><label class="block text-sm font-medium text-gray-700 mb-1">‡∏´‡∏°‡∏π‡πà</label><select id="modalUnitFilter" class="w-full p-2 border border-blue-200 rounded-lg focus:ring-2 focus:ring-blue-500" onchange="updateModalStudentsList()"><option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏π‡πà</option><option value="1">‡∏´‡∏°‡∏π‡πà 1</option><option value="2">‡∏´‡∏°‡∏π‡πà 2</option><option value="3">‡∏´‡∏°‡∏π‡πà 3</option><option value="4">‡∏´‡∏°‡∏π‡πà 4</option></select></div>
                    </div>
                    <div id="attendanceSummary" class="mb-4 p-3 bg-white rounded-lg border border-blue-200 hidden">
                        <div class="flex items-center justify-between mb-2">
                            <h5 class="font-medium text-gray-800">‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°</h5>
                            <div class="flex space-x-4 text-sm"><span class="text-green-600">‚úÖ ‡∏°‡∏≤: <span id="presentCount">0</span> ‡∏Ñ‡∏ô</span><span class="text-red-600">‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏≤: <span id="absentCount">0</span> ‡∏Ñ‡∏ô</span><span class="text-blue-600">üë• ‡∏£‡∏ß‡∏°: <span id="totalInUnit">0</span> ‡∏Ñ‡∏ô</span></div>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2"><div id="attendanceBar" class="bg-green-500 h-2 rounded-full transition-all duration-300" style="width: 0%"></div></div>
                        <p class="text-xs text-gray-600 mt-1">‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°: <span id="attendancePercent">0%</span></p>
                    </div>
                    <div id="studentsChecklist" class="mb-4 hidden">
                        <div class="flex items-center justify-between mb-3">
                            <h5 class="font-medium text-gray-800">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠</h5>
                            <div class="flex space-x-2"><button type="button" onclick="checkAllStudents(true)" class="px-3 py-1 bg-green-500 text-white rounded text-sm hover:bg-green-600">‡πÄ‡∏ä‡πá‡∏Ñ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button><button type="button" onclick="checkAllStudents(false)" class="px-3 py-1 bg-red-500 text-white rounded text-sm hover:bg-red-600">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button></div>
                        </div>
                        <div id="studentCheckboxList" class="max-h-48 overflow-y-auto space-y-2"></div>
                    </div>
                    <div class="flex items-center space-x-4">
                        <button type="button" onclick="selectCheckedStudents()" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 text-sm">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡πá‡∏Ñ‡πÅ‡∏•‡πâ‡∏ß</button>
                        <button type="button" onclick="clearStudentSelection()" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 text-sm">‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</button>
                        <span class="text-sm text-gray-600" id="selectedCount">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å 0 ‡∏Ñ‡∏ô</span>
                    </div>
                    <div id="selectedStudentsList" class="mt-4 space-y-2 max-h-32 overflow-y-auto"></div>
                </div>
                <div class="bg-blue-50 rounded-xl p-4"><h4 class="font-semibold text-blue-800 mb-4">‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</h4><div class="space-y-3" id="rubricItems"></div></div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div><label class="block text-sm font-medium text-gray-700 mb-2">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°</label><input type="number" id="totalScore" min="0" max="100" class="w-full p-3 border border-purple-200 rounded-xl focus:ring-2 focus:ring-purple-500"></div>
                    <div><label class="block text-sm font-medium text-gray-700 mb-2">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</label><select id="gradeLevel" class="w-full p-3 border border-purple-200 rounded-xl focus:ring-2 focus:ring-purple-500"><option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö</option><option value="excellent">‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏° (90-100)</option><option value="good">‡∏î‡∏µ (80-89)</option><option value="fair">‡∏û‡∏≠‡πÉ‡∏ä‡πâ (70-79)</option><option value="poor">‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á (‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 70)</option></select></div>
                </div>
                <div><label class="block text-sm font-medium text-gray-700 mb-2">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô/‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ó‡πå</label><textarea id="comments" rows="4" class="w-full p-3 border border-purple-200 rounded-xl focus:ring-2 focus:ring-purple-500" placeholder="‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°..."></textarea></div>
                <div><label class="block text-sm font-medium text-gray-700 mb-2">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏Å‡∏≥‡∏Å‡∏±‡∏ö</label><textarea id="supervisorNotes" rows="3" class="w-full p-3 border border-purple-200 rounded-xl focus:ring-2 focus:ring-purple-500" placeholder="‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°..."></textarea></div>
                <div class="bg-green-50 rounded-xl p-4">
                    <h4 class="font-semibold text-green-800 mb-4">‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏Å‡∏≥‡∏Å‡∏±‡∏ö</h4>
                    <div class="signature-pad w-full h-32 flex items-center justify-center cursor-pointer" onclick="openSignaturePad()">
                        <div class="text-center text-gray-500"><svg class="w-8 h-8 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path></svg><p class="text-sm">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ã‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠</p></div>
                    </div>
                    <canvas id="signatureCanvas" class="hidden w-full h-32 border-2 border-dashed border-purple-300 rounded-lg"></canvas>
                    <div class="flex space-x-2 mt-2"><button type="button" onclick="clearSignature()" class="px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded-lg hover:bg-gray-200">‡∏•‡πâ‡∏≤‡∏á</button><button type="button" onclick="saveSignature()" class="px-3 py-1 text-sm bg-purple-100 text-purple-600 rounded-lg hover:bg-purple-200">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button></div>
                </div>
                <div class="flex space-x-3 pt-4"><button type="button" onclick="closeActivityModal()" class="flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button><button type="submit" class="flex-1 btn-primary text-white px-4 py-3 rounded-xl">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</button></div>
            </form>
        </div>
    </div>

    <script>
        // --- Google Sheets Integration ---
        // üöÄ **‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:** ‡πÉ‡∏´‡πâ‡∏ô‡∏≥ Web App URL ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£ Deploy ‡πÉ‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2 ‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxo_NIsveuMBLhGecNCABQBnWFx6GDi44PEj5HLlN33V1vX6lnwn0Tx3DQUUu1I64yssg/exec';

        // Global variables
        let students = []; 
        let activities = [];
        let currentSignature = null;
        let selectedStudentsForActivity = [];

        // --- Loading State Management ---
        function showLoading(text = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•...') {
            document.getElementById('loadingText').textContent = text;
            document.getElementById('loadingOverlay').classList.remove('hidden');
        }
        function hideLoading() {
            document.getElementById('loadingOverlay').classList.add('hidden');
        }
        
        // Schedule data
        const scheduleData = {
            m1: {
                title: "‡∏°.1 - ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏±‡∏ß",
                focus: "‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏ß‡∏¥‡∏ô‡∏±‡∏¢ ‚Äì ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô ‚Äì ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏°‡∏π‡πà",
                days: [{
                    day: "‡∏ß‡∏±‡∏ô‡πÅ‡∏£‡∏Å",
                    activities: [
                        { time: "08.30 ‚Äì 09.00", activity: "‡∏û‡∏¥‡∏ò‡∏µ‡πÄ‡∏õ‡∏¥‡∏î / ‡πÄ‡∏Ñ‡∏≤‡∏£‡∏û‡∏ò‡∏á‡∏ä‡∏≤‡∏ï‡∏¥", icon: "üéå" },
                        { time: "09.00 ‚Äì 10.00", activity: "‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡πÅ‡∏ñ‡∏ß (‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô)", icon: "üë•" },
                        { time: "10.00 ‚Äì 10.15", activity: "‡∏û‡∏±‡∏Å", icon: "‚òï" },
                        { time: "10.15 ‚Äì 11.15", activity: "‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô (‡∏û‡∏¥‡∏£‡∏≠‡∏î, ‡∏ï‡∏∞‡∏Å‡∏£‡∏∏‡∏î‡πÄ‡∏ö‡πá‡∏î, ‡∏Ç‡∏±‡∏î‡∏™‡∏°‡∏≤‡∏ò‡∏¥)", icon: "ü™¢" },
                        { time: "11.15 ‚Äì 12.00", activity: "‡πÄ‡∏Å‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå", icon: "üéÆ" },
                        { time: "12.00 ‚Äì 13.00", activity: "‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô", icon: "üçΩÔ∏è" },
                        { time: "13.00 ‚Äì 14.30", activity: "‡πÉ‡∏ä‡πâ‡πÄ‡∏Ç‡πá‡∏°‡∏ó‡∏¥‡∏®‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô", icon: "üß≠" },
                        { time: "14.30 ‚Äì 15.30", activity: "‡πÄ‡∏Å‡∏°‡∏ú‡∏π‡πâ‡∏ô‡∏≥-‡∏ú‡∏π‡πâ‡∏ï‡∏≤‡∏°", icon: "üëë" },
                        { time: "15.30 ‚Äì 16.00", activity: "‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°", icon: "üìù" }
                    ]
                }, {
                    day: "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏á",
                    activities: [
                        { time: "08.30 ‚Äì 09.00", activity: "‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏≤‡∏ò‡∏á", icon: "üéå" },
                        { time: "09.00 ‚Äì 10.00", activity: "‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏Å‡∏• (2‚Äì3 ‡∏Å‡∏°.)", icon: "üö∂" },
                        { time: "10.00 ‚Äì 10.15", activity: "‡∏û‡∏±‡∏Å", icon: "‚òï" },
                        { time: "10.15 ‚Äì 11.15", activity: "‡∏ù‡∏∂‡∏Å‡πÉ‡∏ä‡πâ‡πÄ‡∏Ç‡πá‡∏°‡∏ó‡∏¥‡∏®", icon: "üß≠" },
                        { time: "11.15 ‚Äì 12.00", activity: "‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° Teamwork", icon: "ü§ù" },
                        { time: "12.00 ‚Äì 13.00", activity: "‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô", icon: "üçΩÔ∏è" },
                        { time: "13.00 ‚Äì 14.30", activity: "‡∏ö‡∏≥‡πÄ‡∏û‡πá‡∏ç‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå (‡πÉ‡∏ô‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô)", icon: "üßπ" },
                        { time: "14.30 ‚Äì 15.30", activity: "‡πÄ‡∏û‡∏•‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏Å‡∏°‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠", icon: "üéµ" },
                        { time: "15.30 ‚Äì 16.00", activity: "‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°", icon: "üìù" }
                    ]
                }, {
                    day: "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°",
                    activities: [
                        { time: "08.30 ‚Äì 09.00", activity: "‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏≤‡∏ò‡∏á", icon: "üéå" },
                        { time: "09.00 ‚Äì 10.00", activity: "‡∏õ‡∏ê‡∏°‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ö‡∏≤‡∏î‡πÅ‡∏ú‡∏•‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢", icon: "üè•" },
                        { time: "10.00 ‚Äì 10.15", activity: "‡∏û‡∏±‡∏Å", icon: "‚òï" },
                        { time: "10.15 ‚Äì 11.15", activity: "‡∏Å‡∏≤‡∏£‡∏Å‡πà‡∏≠‡πÑ‡∏ü‡∏á‡πà‡∏≤‡∏¢ ‡πÜ", icon: "üî•" },
                        { time: "11.15 ‚Äì 12.00", activity: "‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏ú‡∏π‡∏Å‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô", icon: "üèÜ" },
                        { time: "12.00 ‚Äì 13.00", activity: "‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô", icon: "üçΩÔ∏è" },
                        { time: "13.00 ‚Äì 14.30", activity: "‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô (‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô + ‡πÄ‡∏Ç‡πá‡∏°‡∏ó‡∏¥‡∏®)", icon: "üìö" },
                        { time: "14.30 ‚Äì 15.30", activity: "‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô‡∏Ñ‡∏¥‡∏î (Reflection)", icon: "üí≠" },
                        { time: "15.30 ‚Äì 16.00", activity: "‡∏û‡∏¥‡∏ò‡∏µ‡∏õ‡∏¥‡∏î + ‡∏°‡∏≠‡∏ö‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥‡∏ö‡∏±‡∏ï‡∏£", icon: "üèÖ" }
                    ]
                }]
            },
            m2: {
                title: "‡∏°.2 - ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö",
                focus: "‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£ ‚Äì ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå ‚Äì ‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏Å‡∏•‡∏à‡∏£‡∏¥‡∏á ‚Äì ‡∏õ‡∏ê‡∏°‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏Ç‡∏±‡πâ‡∏ô‡∏Å‡∏•‡∏≤‡∏á",
                days: [{
                    day: "‡∏ß‡∏±‡∏ô‡πÅ‡∏£‡∏Å",
                    activities: [
                        { time: "08.30 ‚Äì 09.00", activity: "‡∏û‡∏¥‡∏ò‡∏µ‡πÄ‡∏õ‡∏¥‡∏î / ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏≤‡∏ò‡∏á", icon: "üéå" },
                        { time: "09.00 ‚Äì 10.00", activity: "‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡πÅ‡∏ñ‡∏ß‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á (‡πÄ‡∏î‡∏¥‡∏ô‡∏´‡∏°‡∏π‡πà, ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÅ‡∏ñ‡∏ß)", icon: "üë•" },
                        { time: "10.00 ‚Äì 10.15", activity: "‡∏û‡∏±‡∏Å", icon: "‚òï" },
                        { time: "10.15 ‚Äì 11.15", activity: "‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå (‡∏ö‡πà‡∏ß‡∏á‡∏™‡∏≤‡∏¢‡∏ò‡∏ô‡∏π, ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡∏à‡∏±‡∏ö‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤)", icon: "ü™¢" },
                        { time: "11.15 ‚Äì 12.00", activity: "‡πÄ‡∏Å‡∏°‡∏ú‡∏π‡πâ‡∏ô‡∏≥-‡∏ú‡∏π‡πâ‡∏ï‡∏≤‡∏°", icon: "üëë" },
                        { time: "12.00 ‚Äì 13.00", activity: "‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô", icon: "üçΩÔ∏è" },
                        { time: "13.00 ‚Äì 14.30", activity: "‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÄ‡∏Ç‡πá‡∏°‡∏ó‡∏¥‡∏®‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà", icon: "üó∫Ô∏è" },
                        { time: "14.30 ‚Äì 15.30", activity: "‡πÄ‡∏Å‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡∏°", icon: "ü§ù" },
                        { time: "15.30 ‚Äì 16.00", activity: "‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°", icon: "üìù" }
                    ]
                }, {
                    day: "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏á",
                    activities: [
                        { time: "08.30 ‚Äì 09.00", activity: "‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏≤‡∏ò‡∏á", icon: "üéå" },
                        { time: "09.00 ‚Äì 10.00", activity: "‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏Å‡∏• (4‚Äì5 ‡∏Å‡∏°.)", icon: "üö∂" },
                        { time: "10.00 ‚Äì 10.15", activity: "‡∏û‡∏±‡∏Å", icon: "‚òï" },
                        { time: "10.15 ‚Äì 11.15", activity: "‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥ / ‡∏à‡∏∏‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ", icon: "üåø" },
                        { time: "11.15 ‚Äì 12.00", activity: "‡∏ê‡∏≤‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏à/Team Building", icon: "ü§ù" },
                        { time: "12.00 ‚Äì 13.00", activity: "‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô", icon: "üçΩÔ∏è" },
                        { time: "13.00 ‚Äì 14.30", activity: "‡∏ö‡∏≥‡πÄ‡∏û‡πá‡∏ç‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå (‡∏ä‡∏∏‡∏°‡∏ä‡∏ô/‡∏ß‡∏±‡∏î)", icon: "üßπ" },
                        { time: "14.30 ‚Äì 15.30", activity: "‡πÄ‡∏û‡∏•‡∏á‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á", icon: "üéµ" },
                        { time: "15.30 ‚Äì 16.00", activity: "‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°", icon: "üìù" }
                    ]
                }, {
                    day: "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°",
                    activities: [
                        { time: "08.30 ‚Äì 09.00", activity: "‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏≤‡∏ò‡∏á", icon: "üéå" },
                        { time: "09.00 ‚Äì 10.00", activity: "‡∏õ‡∏ê‡∏°‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• (‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏î, ‡∏´‡∏≤‡∏°‡∏ú‡∏π‡πâ‡∏ö‡∏≤‡∏î‡πÄ‡∏à‡πá‡∏ö)", icon: "üè•" },
                        { time: "10.00 ‚Äì 10.15", activity: "‡∏û‡∏±‡∏Å", icon: "‚òï" },
                        { time: "10.15 ‚Äì 11.15", activity: "‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏Å‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß", icon: "üèïÔ∏è" },
                        { time: "11.15 ‚Äì 12.00", activity: "‡πÄ‡∏Å‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå", icon: "üéÆ" },
                        { time: "12.00 ‚Äì 13.00", activity: "‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô", icon: "üçΩÔ∏è" },
                        { time: "13.00 ‚Äì 14.30", activity: "‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏ê‡∏≤‡∏ô‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠ (‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô + ‡πÄ‡∏Ç‡πá‡∏°‡∏ó‡∏¥‡∏® + ‡∏õ‡∏ê‡∏°‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•)", icon: "üèÜ" },
                        { time: "14.30 ‚Äì 15.30", activity: "‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô‡∏Ñ‡∏¥‡∏î", icon: "üí≠" },
                        { time: "15.30 ‚Äì 16.00", activity: "‡∏û‡∏¥‡∏ò‡∏µ‡∏õ‡∏¥‡∏î + ‡∏°‡∏≠‡∏ö‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥‡∏ö‡∏±‡∏ï‡∏£", icon: "üèÖ" }
                    ]
                }]
            },
            m3: {
                title: "‡∏°.3 - ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏ô‡∏≥‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏≤‡∏ï‡∏±‡∏ß‡∏£‡∏≠‡∏î",
                focus: "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏ô‡∏≥ ‚Äì ‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô ‚Äì ‡πÄ‡∏≠‡∏≤‡∏ï‡∏±‡∏ß‡∏£‡∏≠‡∏î ‚Äì ‡∏ñ‡πà‡∏≤‡∏¢‡∏ó‡∏≠‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ",
                days: [{
                    day: "‡∏ß‡∏±‡∏ô‡πÅ‡∏£‡∏Å",
                    activities: [
                        { time: "08.30 ‚Äì 09.00", activity: "‡∏û‡∏¥‡∏ò‡∏µ‡πÄ‡∏õ‡∏¥‡∏î / ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏≤‡∏ò‡∏á", icon: "üéå" },
                        { time: "09.00 ‚Äì 10.00", activity: "‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡πÅ‡∏ñ‡∏ß‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏≤ (‡∏™‡∏±‡πà‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏°‡∏π‡πà)", icon: "üë•" },
                        { time: "10.00 ‚Äì 10.15", activity: "‡∏û‡∏±‡∏Å", icon: "‚òï" },
                        { time: "10.15 ‚Äì 11.15", activity: "‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á (‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡∏ú‡∏π‡∏Å‡∏£‡∏≠‡∏Å, ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡∏™‡∏°‡∏≠)", icon: "ü™¢" },
                        { time: "11.15 ‚Äì 12.00", activity: "‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏†‡∏≤‡∏ß‡∏∞‡∏ú‡∏π‡πâ‡∏ô‡∏≥ (‡∏ù‡∏∂‡∏Å‡∏™‡∏±‡πà‡∏á‡∏Å‡∏≤‡∏£‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏•‡πá‡∏Å)", icon: "üëë" },
                        { time: "12.00 ‚Äì 13.00", activity: "‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô", icon: "üçΩÔ∏è" },
                        { time: "13.00 ‚Äì 14.30", activity: "‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏†‡∏π‡∏°‡∏¥‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®", icon: "üó∫Ô∏è" },
                        { time: "14.30 ‚Äì 15.30", activity: "‡πÄ‡∏Å‡∏°‡∏ú‡∏π‡πâ‡∏ô‡∏≥-‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à", icon: "üéØ" },
                        { time: "15.30 ‚Äì 16.00", activity: "‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°", icon: "üìù" }
                    ]
                }, {
                    day: "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏á",
                    activities: [
                        { time: "08.30 ‚Äì 09.00", activity: "‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏≤‡∏ò‡∏á", icon: "üéå" },
                        { time: "09.00 ‚Äì 10.00", activity: "‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏Å‡∏• (6‚Äì8 ‡∏Å‡∏°. + ‡∏ê‡∏≤‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏≤‡∏á)", icon: "üö∂" },
                        { time: "10.00 ‚Äì 10.15", activity: "‡∏û‡∏±‡∏Å", icon: "‚òï" },
                        { time: "10.15 ‚Äì 11.15", activity: "‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ó‡πâ‡∏≠‡∏á‡∏ñ‡∏¥‡πà‡∏ô / ‡∏†‡∏π‡∏°‡∏¥‡∏õ‡∏±‡∏ç‡∏ç‡∏≤‡∏ä‡∏∏‡∏°‡∏ä‡∏ô", icon: "üåø" },
                        { time: "11.15 ‚Äì 12.00", activity: "‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ú‡∏π‡πâ‡∏ô‡∏≥‡∏ê‡∏≤‡∏ô‡∏¢‡πà‡∏≠‡∏¢", icon: "üëë" },
                        { time: "12.00 ‚Äì 13.00", activity: "‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô", icon: "üçΩÔ∏è" },
                        { time: "13.00 ‚Äì 14.30", activity: "‡∏ö‡∏≥‡πÄ‡∏û‡πá‡∏ç‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå (‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏•‡πá‡∏Å ‡πÜ)", icon: "üßπ" },
                        { time: "14.30 ‚Äì 15.30", activity: "‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏ä‡∏¥‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå (Mini Camp Fire)", icon: "üî•" },
                        { time: "15.30 ‚Äì 16.00", activity: "‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°", icon: "üìù" }
                    ]
                }, {
                    day: "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°",
                    activities: [
                        { time: "08.30 ‚Äì 09.00", activity: "‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏≤‡∏ò‡∏á", icon: "üéå" },
                        { time: "09.00 ‚Äì 10.00", activity: "‡∏õ‡∏ê‡∏°‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á (‡∏î‡∏≤‡∏°‡∏Å‡∏£‡∏∞‡∏î‡∏π‡∏Å, ‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢)", icon: "üè•" },
                        { time: "10.00 ‚Äì 10.15", activity: "‡∏û‡∏±‡∏Å", icon: "‚òï" },
                        { time: "10.15 ‚Äì 11.15", activity: "‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡πÄ‡∏≠‡∏≤‡∏ï‡∏±‡∏ß‡∏£‡∏≠‡∏î (‡∏´‡∏≤‡∏ô‡πâ‡∏≥, ‡∏´‡∏≤‡∏ó‡∏¥‡∏®‡∏à‡∏≤‡∏Å‡∏î‡∏ß‡∏á‡∏î‡∏≤‡∏ß)", icon: "‚≠ê" },
                        { time: "11.15 ‚Äì 12.00", activity: "‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏°.3 ‡∏à‡∏±‡∏î‡∏ê‡∏≤‡∏ô‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≠‡∏á ‡∏°.1‚Äì‡∏°.2", icon: "üéì" },
                        { time: "12.00 ‚Äì 13.00", activity: "‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô", icon: "üçΩÔ∏è" },
                        { time: "13.00 ‚Äì 14.30", activity: "‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏ê‡∏≤‡∏ô‡∏£‡∏ß‡∏° (‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô + ‡πÄ‡∏Ç‡πá‡∏°‡∏ó‡∏¥‡∏® + ‡∏õ‡∏ê‡∏°‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• + ‡∏†‡∏≤‡∏ß‡∏∞‡∏ú‡∏π‡πâ‡∏ô‡∏≥)", icon: "üèÜ" },
                        { time: "14.30 ‚Äì 15.30", activity: "‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô‡∏Ñ‡∏¥‡∏î", icon: "üí≠" },
                        { time: "15.30 ‚Äì 16.00", activity: "‡∏û‡∏¥‡∏ò‡∏µ‡∏õ‡∏¥‡∏î + ‡∏°‡∏≠‡∏ö‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥‡∏ö‡∏±‡∏ï‡∏£", icon: "üèÖ" }
                    ]
                }]
            }
        };
        // Rubric criteria
        const rubricCriteria = {
            default: [
                { criteria: "‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°", maxScore: 20 },
                { criteria: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°", maxScore: 20 },
                { criteria: "‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏≠‡∏∑‡πà‡∏ô", maxScore: 20 },
                { criteria: "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÉ‡∏ô‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤", maxScore: 20 },
                { criteria: "‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡∏Å‡∏é‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö", maxScore: 20 }
            ],
            skill: [
                { criteria: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ", maxScore: 25 },
                { criteria: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥", maxScore: 20 },
                { criteria: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢", maxScore: 25 },
                { criteria: "‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå‡πÉ‡∏ä‡πâ", maxScore: 30 }
            ],
            leadership: [
                { criteria: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏Å‡∏≤‡∏£", maxScore: 25 },
                { criteria: "‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à", maxScore: 25 },
                { criteria: "‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£", maxScore: 25 },
                { criteria: "‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ö‡∏ö‡∏≠‡∏¢‡πà‡∏≤‡∏á", maxScore: 25 }
            ]
        };
        
        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            loadDataFromSheet();
            showTab('schedule');
            
            document.getElementById('mobileMenuBtn').addEventListener('click', () => document.getElementById('mobileMenu').classList.add('open'));
            document.getElementById('closeMobileMenu').addEventListener('click', () => document.getElementById('mobileMenu').classList.remove('open'));
            document.getElementById('addStudentForm').addEventListener('submit', (e) => { e.preventDefault(); addStudent(); });
            document.getElementById('activityForm').addEventListener('submit', (e) => { e.preventDefault(); saveActivityRecord(); });
            document.getElementById('gradeFilter').addEventListener('change', renderStudentsList);
            document.getElementById('groupFilter').addEventListener('change', renderStudentsList);
        });

        // --- NEW & IMPROVED: Functions for Google Sheets Communication ---
        async function loadDataFromSheet() {
            showLoading('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏à‡∏≤‡∏Å Google Sheets...');
            try {
                if (SCRIPT_URL === 'YOUR_WEB_APP_URL_HERE') {
                    throw new Error("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ SCRIPT_URL");
                }
                const [studentsRes, activitiesRes] = await Promise.all([
                    fetch(`${SCRIPT_URL}?action=getStudents`),
                    fetch(`${SCRIPT_URL}?action=getActivities`)
                ]);

                if (!studentsRes.ok || !activitiesRes.ok) throw new Error("Network response was not ok.");

                const studentsResult = await studentsRes.json();
                const activitiesResult = await activitiesRes.json();

                students = studentsResult.success ? (studentsResult.data || []) : [];
                activities = activitiesResult.success ? (activitiesResult.data || []) : [];
                
                localStorage.setItem('scoutStudents', JSON.stringify(students));
                localStorage.setItem('scoutActivities', JSON.stringify(activities));
                
                updateUI();
                
            } catch (error) {
                console.error('Error loading data from Google Sheets:', error);
                alert('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•\n\n‡∏à‡∏∞‡∏•‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)');
                students = JSON.parse(localStorage.getItem('scoutStudents')) || [];
                activities = JSON.parse(localStorage.getItem('scoutActivities')) || [];
                updateUI();
            } finally {
                hideLoading();
            }
        }

        async function syncDataToSheet() {
            if (SCRIPT_URL === 'YOUR_WEB_APP_URL_HERE') {
                alert("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ SCRIPT_URL ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå HTML ‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö");
                return;
            }
            const syncButton = document.getElementById('syncButton');
            const syncButtonText = document.getElementById('syncButtonText');
            const syncIcon = document.getElementById('syncIcon');

            syncButton.disabled = true;
            syncButtonText.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á Sync...';
            syncIcon.classList.add('animate-spin');
            showLoading('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏±‡∏ö Google Sheets...');

            try {
                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        action: 'syncAll', 
                        students: students, 
                        activities: activities 
                    })
                });

                if (!response.ok) {
                    throw new Error(`Network response was not ok, status: ${response.status}`);
                }
                
                const result = await response.json();

                if (result.success) {
                    alert('‚úÖ ' + result.message);
                } else {
                    throw new Error(result.message);
                }

            } catch (error) {
                console.error('Error syncing data:', error);
                alert('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£ Sync ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: ' + error.message);
            } finally {
                syncButton.disabled = false;
                syncButtonText.textContent = 'Sync ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
                syncIcon.classList.remove('animate-spin');
                hideLoading();
            }
        }

        // --- Core Functions ---
        function addStudent() {
            const name = document.getElementById('studentName').value;
            const grade = document.getElementById('studentGrade').value;
            const group = document.getElementById('studentGroup').value;
            const unit = document.getElementById('studentUnit').value;
            const student = { id: Date.now(), name, grade, group, unit };
            students.push(student);
            localStorage.setItem('scoutStudents', JSON.stringify(students));
            closeAddStudentModal();
            updateUI();
            syncDataToSheet();
        }

        function deleteStudent(id) {
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠‡∏Ñ‡∏ô‡∏ô‡∏µ‡πâ?')) {
                students = students.filter(s => s.id !== id);
                localStorage.setItem('scoutStudents', JSON.stringify(students));
                updateUI();
                syncDataToSheet();
            }
        }
        
        function saveActivityRecord() {
            if (!document.getElementById('activityDate').value) {
                alert('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°');
                return;
            }
            if (selectedStudentsForActivity.length === 0) {
                if (!confirm('‚ö†Ô∏è ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠\n\n‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                    alert('üìã ‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠:\n1. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏´‡∏°‡∏π‡πà\n2. ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠\n3. ‡∏Ñ‡∏•‡∏¥‡∏Å "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡πá‡∏Ñ‡πÅ‡∏•‡πâ‡∏ß"');
                    return;
                }
            }
            
            const modal = document.getElementById('activityModal');
            const { grade, dayIndex, actIndex } = modal.dataset;
            const activity = scheduleData[grade].days[dayIndex].activities[actIndex];
            const activityDate = document.getElementById('activityDate').value;
            const totalScore = document.getElementById('totalScore').value || '0';
            const gradeLevel = document.getElementById('gradeLevel').value || 'fair';
            const comments = document.getElementById('comments').value || '';
            const supervisorNotes = document.getElementById('supervisorNotes').value || '';
            const rubricScores = getRubricScores();
            const timestamp = new Date().toISOString();

            const createRecord = (student) => ({
                id: Date.now() + Math.random(),
                studentId: student?.id || null,
                studentName: student?.name || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠',
                studentGrade: student?.grade || grade,
                studentGroup: student?.group || '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î',
                studentUnit: student?.unit || '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î',
                grade, dayIndex, actIndex,
                activityName: activity.activity,
                time: activity.time,
                date: activityDate,
                totalScore, gradeLevel, comments, supervisorNotes, signature: currentSignature,
                rubricScores, timestamp
            });

            if (selectedStudentsForActivity.length > 0) {
                selectedStudentsForActivity.forEach(student => {
                    const record = createRecord(student);
                    activities.push(record);
                });
            } else {
                activities.push(createRecord(null));
            }
            
            localStorage.setItem('scoutActivities', JSON.stringify(activities));
            closeActivityModal();
            updateUI();
            alert(`‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!`);
            syncDataToSheet();
        }

        // --- UI and Helper Functions ---
        function updateUI() {
            updateDashboard();
            renderStudentsList();
            renderRecordsList();
        }
        
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.add('hidden'));
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            document.getElementById(tabName + 'Tab').classList.remove('hidden');
            const activeTab = document.querySelector(`[onclick="showTab('${tabName}')"]`);
            if (activeTab && !activeTab.closest('#mobileMenu')) activeTab.classList.add('active');
            document.getElementById('mobileMenu').classList.remove('open');
            if (tabName === 'dashboard') updateDashboard();
            else if (tabName === 'students') renderStudentsList();
            else if (tabName === 'records') renderRecordsList();
        }
        function showGradeSchedule(grade) {
            const data = scheduleData[grade];
            let html = `<div class="fade-in"><div class="mb-6"><h3 class="text-2xl font-bold text-gray-800 mb-2">${data.title}</h3><p class="text-purple-600 bg-purple-50 rounded-lg p-3"><span class="font-medium">‡∏à‡∏∏‡∏î‡πÄ‡∏ô‡πâ‡∏ô:</span> ${data.focus}</p></div><div class="grid grid-cols-1 lg:grid-cols-3 gap-6">`;
            data.days.forEach((day, dayIndex) => {
                html += `<div class="bg-white/60 backdrop-blur-sm rounded-xl p-4 card-shadow"><h4 class="text-lg font-semibold text-gray-800 mb-4 text-center bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-lg py-2">${day.day}</h4><div class="space-y-3">`;
                day.activities.forEach((activity, actIndex) => {
                    html += `<div class="activity-card bg-white rounded-lg p-3 flex items-center justify-between"><div class="flex items-center space-x-3 flex-1"><span class="text-xl">${activity.icon}</span><div class="flex-1"><p class="text-xs text-purple-600 font-medium">${activity.time}</p><p class="text-sm text-gray-800 font-medium">${activity.activity}</p></div></div><button onclick="openActivityModal('${grade}', ${dayIndex}, ${actIndex})" class="bg-purple-500 hover:bg-purple-600 text-white px-3 py-1 rounded-lg text-xs font-medium flex items-center space-x-1"><span>üìù</span><span>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</span></button></div>`;
                });
                html += `</div></div>`;
            });
            html += '</div></div>';
            document.getElementById('scheduleContent').innerHTML = html;
        }
        function showAddStudentModal() { document.getElementById('addStudentModal').classList.remove('hidden'); }
        function closeAddStudentModal() { document.getElementById('addStudentModal').classList.add('hidden'); document.getElementById('addStudentForm').reset(); }
        function renderStudentsList() {
            const gradeFilter = document.getElementById('gradeFilter').value;
            const groupFilter = document.getElementById('groupFilter').value;
            let filteredStudents = students.filter(s => (!gradeFilter || s.grade === gradeFilter) && (!groupFilter || s.group === groupFilter));
            const container = document.getElementById('studentsList');
            if (filteredStudents.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-500 py-8">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠</p>'; return;
            }
            const grouped = filteredStudents.reduce((acc, student) => {
                const key = `${student.grade}-${student.group}-${student.unit}`;
                if (!acc[key]) acc[key] = { ...student, students: [] };
                acc[key].students.push(student);
                return acc;
            }, {});
            let html = '';
            Object.values(grouped).forEach(group => {
                const gradeText = group.grade === 'm1' ? '‡∏°.1' : group.grade === 'm2' ? '‡∏°.2' : '‡∏°.3';
                html += `<div class="bg-white/60 backdrop-blur-sm rounded-xl p-4 card-shadow"><h4 class="font-semibold text-gray-800 mb-3 flex items-center"><span class="mr-2">üéØ</span>${gradeText} - ‡∏Å‡∏≠‡∏á ${group.group} - ‡∏´‡∏°‡∏π‡πà ${group.unit}</h4><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">`;
                group.students.forEach(student => {
                    html += `<div class="bg-white rounded-lg p-3 flex items-center justify-between"><div class="flex items-center space-x-3"><div class="w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center"><span class="text-purple-600 text-sm">üë§</span></div><span class="text-sm font-medium text-gray-800">${student.name}</span></div><button onclick="deleteStudent(${student.id})" class="text-red-500 hover:text-red-700 p-1 rounded"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div>`;
                });
                html += '</div></div>';
            });
            container.innerHTML = html;
        }
        function openActivityModal(grade, dayIndex, actIndex) {
            const activity = scheduleData[grade].days[dayIndex].activities[actIndex];
            document.getElementById('activityModalTitle').textContent = `‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°: ${activity.activity}`;
            document.getElementById('activityTime').value = activity.time;
            document.getElementById('activityDate').valueAsDate = new Date();
            let rubricType = 'default';
            if (activity.activity.includes('‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô') || activity.activity.includes('‡πÄ‡∏Ç‡πá‡∏°‡∏ó‡∏¥‡∏®') || activity.activity.includes('‡∏õ‡∏ê‡∏°‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•')) rubricType = 'skill';
            else if (activity.activity.includes('‡∏ú‡∏π‡πâ‡∏ô‡∏≥') || activity.activity.includes('‡∏™‡∏±‡πà‡∏á‡∏Å‡∏≤‡∏£')) rubricType = 'leadership';
            renderRubricItems(rubricType);
            const modal = document.getElementById('activityModal');
            modal.dataset.grade = grade;
            modal.dataset.dayIndex = dayIndex;
            modal.dataset.actIndex = actIndex;
            selectedStudentsForActivity = [];
            document.getElementById('modalGroupFilter').value = '';
            document.getElementById('modalUnitFilter').value = '';
            updateSelectedStudentsList();
            document.getElementById('studentsChecklist').classList.add('hidden');
            document.getElementById('attendanceSummary').classList.add('hidden');
            modal.classList.remove('hidden');
            modal.querySelector('.max-h-\\[90vh\\]').scrollTop = 0;
        }
        function updateModalStudentsList() {
            const grade = document.getElementById('activityModal').dataset.grade;
            const group = document.getElementById('modalGroupFilter').value;
            const unit = document.getElementById('modalUnitFilter').value;
            let filtered = students.filter(s => s.grade === grade && s.group === group && (!unit || s.unit === unit));
            const checklistDiv = document.getElementById('studentsChecklist');
            const summaryDiv = document.getElementById('attendanceSummary');
            if (group && unit && filtered.length > 0) {
                checklistDiv.classList.remove('hidden');
                summaryDiv.classList.remove('hidden');
                renderStudentCheckboxes(filtered);
                updateAttendanceSummary(filtered);
            } else {
                checklistDiv.classList.add('hidden');
                summaryDiv.classList.add('hidden');
            }
        }
        function renderStudentCheckboxes(students) {
            const container = document.getElementById('studentCheckboxList');
            let html = '';
            students.forEach(student => {
                const isSelected = selectedStudentsForActivity.find(s => s.id === student.id);
                html += `<label class="flex items-center justify-between bg-white rounded-lg p-3 border border-gray-200 cursor-pointer"><div class="flex items-center space-x-3"><input type="checkbox" data-student-id="${student.id}" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500" onchange="updateAttendanceFromCheckbox()" ${isSelected ? 'checked' : ''}><span class="text-sm font-medium text-gray-800">${student.name}</span></div><div class="flex items-center space-x-2"><span class="text-xs bg-blue-100 text-blue-600 px-2 py-1 rounded">‡∏Å‡∏≠‡∏á ${student.group}</span><span class="text-xs bg-green-100 text-green-600 px-2 py-1 rounded">‡∏´‡∏°‡∏π‡πà ${student.unit}</span></div></label>`;
            });
            container.innerHTML = html;
        }
        function updateAttendanceSummary(allStudents) {
            const presentCount = document.querySelectorAll('#studentCheckboxList input:checked').length;
            const totalCount = allStudents.length;
            const absentCount = totalCount - presentCount;
            const percentage = totalCount > 0 ? Math.round((presentCount / totalCount) * 100) : 0;
            document.getElementById('presentCount').textContent = presentCount;
            document.getElementById('absentCount').textContent = absentCount;
            document.getElementById('totalInUnit').textContent = totalCount;
            document.getElementById('attendancePercent').textContent = percentage + '%';
            const bar = document.getElementById('attendanceBar');
            bar.style.width = percentage + '%';
            bar.className = `h-2 rounded-full transition-all duration-300 ${percentage >= 80 ? 'bg-green-500' : percentage >= 60 ? 'bg-yellow-500' : 'bg-red-500'}`;
        }
        function updateAttendanceFromCheckbox() {
            const grade = document.getElementById('activityModal').dataset.grade;
            const group = document.getElementById('modalGroupFilter').value;
            const unit = document.getElementById('modalUnitFilter').value;
            const allStudentsInUnit = students.filter(s => s.grade === grade && s.group === group && s.unit === unit);
            updateAttendanceSummary(allStudentsInUnit);
        }
        function checkAllStudents(checked) {
            document.querySelectorAll('#studentCheckboxList input[type="checkbox"]').forEach(c => c.checked = checked);
            updateAttendanceFromCheckbox();
        }
        function selectCheckedStudents() {
            selectedStudentsForActivity = [];
            document.querySelectorAll('#studentCheckboxList input:checked').forEach(checkbox => {
                const studentId = parseInt(checkbox.dataset.studentId);
                const student = students.find(s => s.id === studentId);
                if (student && !selectedStudentsForActivity.find(s => s.id === student.id)) {
                    selectedStudentsForActivity.push(student);
                }
            });
            updateSelectedStudentsList();
        }
        function clearStudentSelection() { selectedStudentsForActivity = []; updateSelectedStudentsList(); }
        function removeSelectedStudent(studentId) { selectedStudentsForActivity = selectedStudentsForActivity.filter(s => s.id !== studentId); updateSelectedStudentsList(); }
        function updateSelectedStudentsList() {
            const container = document.getElementById('selectedStudentsList');
            const count = document.getElementById('selectedCount');
            count.textContent = `‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ${selectedStudentsForActivity.length} ‡∏Ñ‡∏ô`;
            if (selectedStudentsForActivity.length === 0) {
                container.innerHTML = '<p class="text-sm text-gray-500 text-center py-2">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠</p>'; return;
            }
            let html = '';
            selectedStudentsForActivity.forEach(student => {
                const gradeText = student.grade === 'm1' ? '‡∏°.1' : student.grade === 'm2' ? '‡∏°.2' : '‡∏°.3';
                html += `<div class="flex items-center justify-between bg-white rounded-lg p-2 border border-blue-200"><div class="flex items-center space-x-2"><span class="text-xs bg-blue-100 text-blue-600 px-2 py-1 rounded">${gradeText}</span><span class="text-sm font-medium">${student.name}</span><span class="text-xs text-gray-500">‡∏Å‡∏≠‡∏á ${student.group} ‡∏´‡∏°‡∏π‡πà ${student.unit}</span></div><button type="button" onclick="removeSelectedStudent(${student.id})" class="text-red-500 hover:text-red-700 p-1"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div>`;
            });
            container.innerHTML = html;
        }
        function closeActivityModal() { document.getElementById('activityModal').classList.add('hidden'); document.getElementById('activityForm').reset(); clearSignature(); selectedStudentsForActivity = []; }
        function renderRubricItems(type) {
            const criteria = rubricCriteria[type];
            let html = '';
            criteria.forEach((item, index) => {
                html += `<div class="rubric-item p-3"><div class="flex items-center justify-between mb-2"><span class="text-sm font-medium text-gray-700">${item.criteria}</span><span class="text-xs text-purple-600">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏ï‡πá‡∏° ${item.maxScore}</span></div><div class="flex items-center space-x-2"><input type="range" min="0" max="${item.maxScore}" value="0" class="flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer" id="rubric_${index}" oninput="updateRubricScore(${index}, this.value)"><span class="text-sm font-medium text-purple-600 w-12 text-center" id="score_${index}">0</span></div></div>`;
            });
            document.getElementById('rubricItems').innerHTML = html;
        }
        function updateRubricScore(index, value) {
            document.getElementById(`score_${index}`).textContent = value;
            let total = 0;
            document.querySelectorAll('[id^="rubric_"]').forEach(item => { total += parseInt(item.value); });
            document.getElementById('totalScore').value = total;
            const gradeSelect = document.getElementById('gradeLevel');
            if (total >= 90) gradeSelect.value = 'excellent';
            else if (total >= 80) gradeSelect.value = 'good';
            else if (total >= 70) gradeSelect.value = 'fair';
            else gradeSelect.value = 'poor';
        }
        function getRubricScores() {
            const scores = [];
            document.querySelectorAll('[id^="rubric_"]').forEach((item, index) => {
                const criteriaText = item.closest('.rubric-item').querySelector('.text-gray-700').textContent.trim();
                scores.push({ criteria: criteriaText, score: parseInt(item.value) || 0, maxScore: parseInt(item.max) || 20 });
            });
            return scores;
        }
        function openSignaturePad() {
            const canvas = document.getElementById('signatureCanvas');
            const pad = document.querySelector('.signature-pad');
            canvas.classList.remove('hidden');
            pad.classList.add('hidden');
            const ctx = canvas.getContext('2d');
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
            let isDrawing = false;
            const start = (e) => {
                isDrawing = true;
                const pos = getPos(e);
                ctx.beginPath();
                ctx.moveTo(pos.x, pos.y);
            };
            const draw = (e) => {
                if (!isDrawing) return;
                e.preventDefault();
                const pos = getPos(e);
                ctx.lineTo(pos.x, pos.y);
                ctx.stroke();
            };
            const stop = () => { isDrawing = false; };
            const getPos = (e) => {
                const rect = canvas.getBoundingClientRect();
                return { x: (e.clientX || e.touches[0].clientX) - rect.left, y: (e.clientY || e.touches[0].clientY) - rect.top };
            };
            ['mousedown', 'touchstart'].forEach(e => canvas.addEventListener(e, start));
            ['mousemove', 'touchmove'].forEach(e => canvas.addEventListener(e, draw));
            ['mouseup', 'touchend'].forEach(e => canvas.addEventListener(e, stop));
        }
        function clearSignature() {
            const canvas = document.getElementById('signatureCanvas');
            canvas.getContext('2d').clearRect(0, 0, canvas.width, canvas.height);
            currentSignature = null;
        }
        function saveSignature() {
            currentSignature = document.getElementById('signatureCanvas').toDataURL();
            const pad = document.querySelector('.signature-pad');
            pad.innerHTML = `<div class="text-center text-green-600"><svg class="w-8 h-8 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg><p class="text-sm">‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß</p></div>`;
            document.getElementById('signatureCanvas').classList.add('hidden');
            pad.classList.remove('hidden');
        }
        function updateDashboard() {
            document.getElementById('totalStudents').textContent = students.length;
            document.getElementById('m1Stats').textContent = `${students.filter(s => s.grade === 'm1').length} ‡∏Ñ‡∏ô`;
            document.getElementById('m2Stats').textContent = `${students.filter(s => s.grade === 'm2').length} ‡∏Ñ‡∏ô`;
            document.getElementById('m3Stats').textContent = `${students.filter(s => s.grade === 'm3').length} ‡∏Ñ‡∏ô`;
            document.getElementById('todayAttendance').textContent = activities.length;
            const uniqueActivities = [...new Set(activities.map(a => a.activityName))];
            document.getElementById('todayActivities').textContent = uniqueActivities.length;
            if (activities.length > 0) {
                const totalScore = activities.reduce((sum, act) => sum + parseInt(act.totalScore || 0), 0);
                document.getElementById('averageScore').textContent = (totalScore / activities.length).toFixed(1);
            } else {
                document.getElementById('averageScore').textContent = '0';
            }
        }
        function renderRecordsList() {
            const container = document.getElementById('recordsList');
            if (activities.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-500 py-8">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</p>'; return;
            }
            let html = '';
            activities.slice().reverse().forEach(record => {
                const gradeText = record.grade === 'm1' ? '‡∏°.1' : record.grade === 'm2' ? '‡∏°.2' : '‡∏°.3';
                const gradeColors = { excellent: 'text-green-600', good: 'text-blue-600', fair: 'text-yellow-600', poor: 'text-red-600' };
                html += `<div class="bg-white/60 backdrop-blur-sm rounded-xl p-4 card-shadow"><div class="flex items-start justify-between mb-3"><div><h4 class="font-semibold text-gray-800">${record.activityName}</h4><p class="text-sm text-purple-600">${gradeText} ‚Ä¢ ${record.time} ‚Ä¢ ${record.date}</p>${record.studentId ? `<div class="flex items-center space-x-2 mt-1"><span class="text-xs bg-blue-100 text-blue-600 px-2 py-1 rounded">üë§</span><span class="text-sm text-gray-700">${record.studentName}</span><span class="text-xs text-gray-500">‡∏Å‡∏≠‡∏á ${record.studentGroup} ‡∏´‡∏°‡∏π‡πà ${record.studentUnit}</span></div>` : ''}</div><div class="text-right"><p class="text-lg font-bold ${gradeColors[record.gradeLevel] || 'text-gray-600'}">${record.totalScore}/100</p><p class="text-xs text-gray-500">${new Date(record.timestamp).toLocaleString('th-TH')}</p></div></div>${record.comments ? `<div class="bg-blue-50 rounded-lg p-3 mb-3"><p class="text-sm text-blue-800"><strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô:</strong> ${record.comments}</p></div>` : ''}${record.supervisorNotes ? `<div class="bg-green-50 rounded-lg p-3 mb-3"><p class="text-sm text-green-800"><strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏π‡πâ‡∏Å‡∏≥‡∏Å‡∏±‡∏ö:</strong> ${record.supervisorNotes}</p></div>` : ''}${record.signature ? `<div class="flex items-center space-x-2 text-sm text-gray-600"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path></svg><span>‡∏°‡∏µ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏Å‡∏≥‡∏Å‡∏±‡∏ö</span></div>` : ''}</div>`;
            });
            container.innerHTML = html;
        }
    </script>
</body>
</html>
